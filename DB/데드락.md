## 데드락 (DeadLock)
- 둘 이상의 트랜잭션이 서로의 자원을 기다리면서 무한 대기 상태에 빠지는 현상
- 예를 들어, 트랜잭션 a가 자원 x를 잠근 상태에서 자원 y를 기다리고 있고, 동시에 트랜잭션 b가 자원 y를 잠근 상태에서 자원 x를 기다리고 있는 상황
- 이 경우 두 트랜잭션은 서로의 자원을 기다리며 교착 상태에 빠져, 영원히 진행되지 못하게 된다

## 데드락 해결 방법
- 예방
- 탐지
- 회복

## 데드락 예방
데드락이 발생하지 않도록 사전에 방지하는 방법입니다. 이를 위해 여러 가지 전략을 사용할 수 있습니다.

자원 할당 순서 지정: 모든 트랜잭션이 자원을 특정한 순서로 요청하도록 합니다. 이를 통해 순환적인 대기가 발생하지 않도록 합니다. 예를 들어, 항상 자원 X를 먼저 요청하고, 그다음 자원 Y를 요청하도록 강제하는 것입니다.
한 번에 모든 자원 할당: 트랜잭션이 필요한 모든 자원을 한꺼번에 요청하게 하여, 필요한 자원을 전부 확보할 수 있을 때만 트랜잭션을 시작하도록 합니다. 그러나 이 방법은 자원의 효율적 사용을 저해할 수 있습니다.
타임아웃 설정: 자원을 일정 시간 동안 획득하지 못하면 트랜잭션이 자동으로 중단되도록 합니다. 타임아웃이 발생하면 트랜잭션을 롤백하고 다시 시도합니다.

## 데드락 탐지
데드락이 발생한 후 이를 탐지하고 해결하는 방법입니다.

데드락 탐지 알고리즘: 시스템은 트랜잭션의 잠금 상태를 모니터링하여 데드락을 탐지합니다. 대부분의 데이터베이스 시스템은 주기적으로 데드락을 감지하는 메커니즘을 가지고 있습니다.
대기 그래프(Wait-For Graph): 시스템은 트랜잭션 간의 대기 관계를 그래프로 표현하여 순환 대기가 있는지 탐지합니다. 순환 대기가 발견되면 데드락이 발생한 것으로 판단합니다.

## 데드락 회복
데드락이 발생한 후 이를 해결하는 방법입니다.

트랜잭션 강제 종료: 데드락 상태에 있는 트랜잭션 중 하나를 강제 종료(롤백)하여 교착 상태를 해소합니다. 이때, 롤백할 트랜잭션을 선택하는 기준은 일반적으로 트랜잭션이 수행한 작업의 양(작업이 적은 트랜잭션을 종료)이나 트랜잭션이 가진 우선순위 등을 고려합니다.
타임아웃에 의한 롤백: 일정 시간 동안 자원을 확보하지 못한 트랜잭션은 자동으로 롤백되도록 하여 데드락을 해소합니다.

## 일반적인 대응 방법
트랜잭션 설계 개선: 트랜잭션이 자원을 요청하는 순서를 일관되게 설계하고, 트랜잭션이 자원을 잠그는 시간을 최소화하도록 설계합니다.
잠금 범위 최소화: 트랜잭션이 잠그는 자원의 범위와 시간을 최소화하여 데드락 발생 가능성을 줄입니다.
재시도 로직: 애플리케이션 레벨에서 데드락이 발생할 경우 트랜잭션을 재시도하는 로직을 구현할 수 있습니다. 이는 데이터베이스의 DEADLOCK 오류를 감지하여 트랜잭션을 롤백하고 다시 시도하는 방식입니다.